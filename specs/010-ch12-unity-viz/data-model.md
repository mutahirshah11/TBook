# Data Model: Chapter 12 - Unity for Robot Visualization

**Feature**: `010-ch12-unity-viz` | **Date**: 2025-12-07

## Entities

### Unity Project Structure
*Represents the organized assets required for the visualization environment.*

| Entity | Description | Attributes |
| :--- | :--- | :--- |
| **Scenes** | The 3D environments. | `MainScene.unity` (The visualization stage) |
| **RosSettings** | Configuration for the TCP connection. | `ROS IP`: string (WSL2 IP)<br>`Host Port`: int (10000)<br>`Protocol`: enum (ROS2) |
| **URDF Asset** | The imported robot model files. | `Assets/URDF/RobotName/`: directory<br>`*.urdf`: file<br>`Materials/`: directory<br>`Meshes/`: directory |
| **Scripts** | C# code for custom logic. | `RosSubscriber.cs`: Component<br>`RosPublisher.cs`: Component |

### Runtime Objects
*Represents the GameObjects instantiated during simulation.*

| Entity | Description | Components |
| :--- | :--- | :--- |
| **RobotRoot** | The base of the robot. | `ArticulationBody` (Fixed/Immovable)<br>`UrdfRobot` (Controller script) |
| **RobotLink** | A moving part of the robot. | `ArticulationBody` (Dynamic)<br>`MeshRenderer` (Visual)<br>`MeshCollider` (Physics) |
| **RosConnector** | The active connection manager. | `ROSConnection` (Singleton) |

### ROS2 Messages (C# Generation)
*Represents the data structures exchanged between Unity and ROS2.*

| Message | Fields (ROS2) | Fields (C# Struct) |
| :--- | :--- | :--- |
| **geometry_msgs/Twist** | `Vector3 linear`<br>`Vector3 angular` | `Vector3Msg linear`<br>`Vector3Msg angular` |
| **sensor_msgs/JointState** | `string[] name`<br>`float64[] position` | `string[] name`<br>`double[] position` |
| **std_msgs/ColorRGBA** | `float32 r, g, b, a` | `float r, g, b, a` |

## Validation Rules

1. **Hierarchy**: All `ArticulationBody` components MUST be part of a single contiguous parent-child hierarchy.
2. **Naming**: Unity GameObject names generated by URDF Importer MUST match the `link` names in the URDF file.
3. **Coordinate Frame**: Unity uses Left-Handed (Y-up) coordinates; ROS uses Right-Handed (Z-up). The `ROS-TCP-Connector` handles this conversion automatically, but users must be aware when writing custom C# scripts.

## State Transitions

1. **Disconnected** -> **Connected**: When the Unity Play Mode starts and the ROS-TCP-Endpoint is reachable.
2. **Connected** -> **Simulating**: When messages begin flowing (e.g., `JointState` updates moving the robot).
3. **Simulating** -> **Error**: If the TCP connection drops or a message serialization error occurs.
